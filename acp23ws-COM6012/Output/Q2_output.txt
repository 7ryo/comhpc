/users/acp23ws/com6012/comhpc/acp23ws-COM6012/Q2_1.py:11: DeprecationWarning: load_dataset is deprecated and will be removed in a future version.
  df = kagglehub.load_dataset(
First 5 records:    encounter_id  patient_nbr             race  ... change diabetesMed readmitted
0       2278392      8222157        Caucasian  ...     No          No         NO
1        149190     55629189        Caucasian  ...     Ch         Yes        >30
2         64410     86047875  AfricanAmerican  ...     No         Yes         NO
3        500364     82442376        Caucasian  ...     Ch         Yes         NO
4         16680     42519267        Caucasian  ...     Ch         Yes         NO

[5 rows x 50 columns]
25/05/06 12:57:30 INFO SparkContext: Running Spark version 3.5.4
25/05/06 12:57:30 INFO SparkContext: OS info Linux, 3.10.0-1160.132.1.el7.x86_64, amd64
25/05/06 12:57:30 INFO SparkContext: Java version 17.0.4
25/05/06 12:57:30 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
25/05/06 12:57:30 WARN SparkConf: Note that spark.local.dir will be overridden by the value set by the cluster manager (via SPARK_LOCAL_DIRS in mesos/standalone/kubernetes and LOCAL_DIRS in YARN).
25/05/06 12:57:30 INFO ResourceUtils: ==============================================================
25/05/06 12:57:30 INFO ResourceUtils: No custom resources configured for spark.driver.
25/05/06 12:57:30 INFO ResourceUtils: ==============================================================
25/05/06 12:57:30 INFO SparkContext: Submitted application: Question2
25/05/06 12:57:30 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
25/05/06 12:57:30 INFO ResourceProfile: Limiting resource is cpu
25/05/06 12:57:30 INFO ResourceProfileManager: Added ResourceProfile id: 0
25/05/06 12:57:30 INFO SecurityManager: Changing view acls to: acp23ws
25/05/06 12:57:30 INFO SecurityManager: Changing modify acls to: acp23ws
25/05/06 12:57:30 INFO SecurityManager: Changing view acls groups to: 
25/05/06 12:57:30 INFO SecurityManager: Changing modify acls groups to: 
25/05/06 12:57:30 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users with view permissions: acp23ws; groups with view permissions: EMPTY; users with modify permissions: acp23ws; groups with modify permissions: EMPTY
25/05/06 12:57:31 INFO Utils: Successfully started service 'sparkDriver' on port 41002.
25/05/06 12:57:31 INFO SparkEnv: Registering MapOutputTracker
25/05/06 12:57:31 INFO SparkEnv: Registering BlockManagerMaster
25/05/06 12:57:31 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
25/05/06 12:57:31 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
25/05/06 12:57:31 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
25/05/06 12:57:31 INFO DiskBlockManager: Created local directory at /mnt/parscratch/users/acp23ws/blockmgr-c34e7be5-8121-44f1-8025-d6a48bfa989c
25/05/06 12:57:31 INFO MemoryStore: MemoryStore started with capacity 413.9 MiB
25/05/06 12:57:31 INFO SparkEnv: Registering OutputCommitCoordinator
25/05/06 12:57:31 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
25/05/06 12:57:31 INFO Utils: Successfully started service 'SparkUI' on port 4040.
25/05/06 12:57:31 INFO Executor: Starting executor ID driver on host node140.pri.stanage.alces.network
25/05/06 12:57:31 INFO Executor: OS info Linux, 3.10.0-1160.132.1.el7.x86_64, amd64
25/05/06 12:57:31 INFO Executor: Java version 17.0.4
25/05/06 12:57:31 INFO Executor: Starting executor with user classpath (userClassPathFirst = false): ''
25/05/06 12:57:31 INFO Executor: Created or updated repl class loader org.apache.spark.util.MutableURLClassLoader@65926fa for default.
25/05/06 12:57:31 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 37784.
25/05/06 12:57:31 INFO NettyBlockTransferService: Server created on node140.pri.stanage.alces.network:37784
25/05/06 12:57:31 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
25/05/06 12:57:31 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, node140.pri.stanage.alces.network, 37784, None)
25/05/06 12:57:31 INFO BlockManagerMasterEndpoint: Registering block manager node140.pri.stanage.alces.network:37784 with 413.9 MiB RAM, BlockManagerId(driver, node140.pri.stanage.alces.network, 37784, None)
25/05/06 12:57:31 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, node140.pri.stanage.alces.network, 37784, None)
25/05/06 12:57:31 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, node140.pri.stanage.alces.network, 37784, None)
25/05/06 12:57:51 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
25/05/06 12:57:52 WARN TaskSetManager: Stage 0 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
+---------+-----------+-----------+--------------+-----------+-------------+---------+---------+-----------+------------+-------------+--------+--------+------------+----------+-------+-----------+-------+-------------------+-------------------+------------------------+-----------------------+----------------------+----------+----------------+
|metformin|repaglinide|nateglinide|chlorpropamide|glimepiride|acetohexamide|glipizide|glyburide|tolbutamide|pioglitazone|rosiglitazone|acarbose|miglitol|troglitazone|tolazamide|examide|citoglipton|insulin|glyburide-metformin|glipizide-metformin|glimepiride-pioglitazone|metformin-rosiglitazone|metformin-pioglitazone|readmitted|time_in_hospital|
+---------+-----------+-----------+--------------+-----------+-------------+---------+---------+-----------+------------+-------------+--------+--------+------------+----------+-------+-----------+-------+-------------------+-------------------+------------------------+-----------------------+----------------------+----------+----------------+
|        0|          0|          0|             0|          0|            0|        0|        0|          0|           0|            0|       0|       0|           0|         0|      0|          0|      0|                  0|                  0|                       0|                      0|                     0|        NO|               1|
|        0|          0|          0|             0|          0|            0|        0|        0|          0|           0|            0|       0|       0|           0|         0|      0|          0|      1|                  0|                  0|                       0|                      0|                     0|       >30|               3|
|        0|          0|          0|             0|          0|            0|        1|        0|          0|           0|            0|       0|       0|           0|         0|      0|          0|      0|                  0|                  0|                       0|                      0|                     0|        NO|               2|
|        0|          0|          0|             0|          0|            0|        0|        0|          0|           0|            0|       0|       0|           0|         0|      0|          0|      1|                  0|                  0|                       0|                      0|                     0|        NO|               2|
|        0|          0|          0|             0|          0|            0|        1|        0|          0|           0|            0|       0|       0|           0|         0|      0|          0|      1|                  0|                  0|                       0|                      0|                     0|        NO|               1|
+---------+-----------+-----------+--------------+-----------+-------------+---------+---------+-----------+------------+-------------+--------+--------+------------+----------+-------+-----------+-------+-------------------+-------------------+------------------------+-----------------------+----------------------+----------+----------------+
only showing top 5 rows

25/05/06 12:58:00 WARN TaskSetManager: Stage 1 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
+----------+----------------+---------------------+
|readmitted|time_in_hospital|onehot               |
+----------+----------------+---------------------+
|NO        |1               |(23,[],[])           |
|>30       |3               |(23,[17],[1.0])      |
|NO        |2               |(23,[6],[1.0])       |
|NO        |2               |(23,[17],[1.0])      |
|NO        |1               |(23,[6,17],[1.0,1.0])|
+----------+----------------+---------------------+
only showing top 5 rows

DataFrame[readmitted: double, count: bigint]
25/05/06 12:58:02 WARN TaskSetManager: Stage 2 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
+----------+----------------+--------------------+
|readmitted|time_in_hospital|              onehot|
+----------+----------------+--------------------+
|       0.0|               1|          (23,[],[])|
|       1.0|               3|     (23,[17],[1.0])|
|       0.0|               2|      (23,[6],[1.0])|
|       0.0|               2|     (23,[17],[1.0])|
|       0.0|               1|(23,[6,17],[1.0,1...|
+----------+----------------+--------------------+
only showing top 5 rows

model training
25/05/06 12:58:04 WARN TaskSetManager: Stage 3 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:08 WARN InstanceBuilder: Failed to load implementation from:dev.ludovic.netlib.blas.JNIBLAS
25/05/06 12:58:08 WARN InstanceBuilder: Failed to load implementation from:dev.ludovic.netlib.blas.VectorBLAS
25/05/06 12:58:08 WARN InstanceBuilder: Failed to load implementation from:dev.ludovic.netlib.lapack.JNILAPACK
25/05/06 12:58:08 WARN TaskSetManager: Stage 4 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:10 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:15 WARN TaskSetManager: Stage 5 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:16 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:16 WARN TaskSetManager: Stage 6 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:17 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:17 WARN TaskSetManager: Stage 7 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:18 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:18 WARN TaskSetManager: Stage 8 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:20 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:20 WARN TaskSetManager: Stage 9 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:21 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:21 WARN TaskSetManager: Stage 10 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:22 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:22 WARN TaskSetManager: Stage 11 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:24 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:24 WARN TaskSetManager: Stage 12 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:25 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:25 WARN TaskSetManager: Stage 13 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:26 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:26 WARN TaskSetManager: Stage 14 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:27 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:27 WARN TaskSetManager: Stage 15 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:28 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:28 WARN TaskSetManager: Stage 16 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:31 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:31 WARN TaskSetManager: Stage 17 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:32 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:32 WARN TaskSetManager: Stage 18 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:33 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:33 WARN TaskSetManager: Stage 19 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:34 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:34 WARN TaskSetManager: Stage 20 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:35 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:35 WARN TaskSetManager: Stage 21 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:36 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:37 WARN TaskSetManager: Stage 22 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:38 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:38 WARN TaskSetManager: Stage 23 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:39 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:39 WARN TaskSetManager: Stage 24 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:40 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:40 WARN TaskSetManager: Stage 25 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:41 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:41 WARN TaskSetManager: Stage 26 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:42 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:42 WARN TaskSetManager: Stage 27 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:44 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:44 WARN TaskSetManager: Stage 28 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:45 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:45 WARN TaskSetManager: Stage 29 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:46 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:46 WARN TaskSetManager: Stage 30 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:47 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:47 WARN TaskSetManager: Stage 31 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:48 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:48 WARN TaskSetManager: Stage 32 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:50 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:50 WARN TaskSetManager: Stage 33 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:51 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:52 WARN TaskSetManager: Stage 34 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:52 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:53 WARN TaskSetManager: Stage 35 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:54 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:54 WARN TaskSetManager: Stage 36 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:55 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:55 WARN TaskSetManager: Stage 37 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:56 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:56 WARN TaskSetManager: Stage 38 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:57 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:57 WARN TaskSetManager: Stage 39 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:58 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:58 WARN TaskSetManager: Stage 40 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:58:59 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:58:59 WARN TaskSetManager: Stage 41 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:00 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:00 WARN TaskSetManager: Stage 42 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:01 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:01 WARN TaskSetManager: Stage 43 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:02 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:02 WARN TaskSetManager: Stage 44 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:03 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:03 WARN TaskSetManager: Stage 45 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:05 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:05 WARN TaskSetManager: Stage 46 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:06 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:06 WARN TaskSetManager: Stage 47 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:07 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:07 WARN TaskSetManager: Stage 48 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:09 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:09 WARN TaskSetManager: Stage 49 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:10 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:10 WARN TaskSetManager: Stage 50 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:11 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:11 WARN TaskSetManager: Stage 51 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:12 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:12 WARN TaskSetManager: Stage 52 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:13 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:13 WARN TaskSetManager: Stage 53 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:15 WARN Instrumentation: [442de9cf] Cholesky solver failed due to singular covariance matrix. Retrying with Quasi-Newton solver.
25/05/06 12:59:16 WARN TaskSetManager: Stage 54 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:18 WARN TaskSetManager: Stage 55 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
RMSE = 4.25763 

25/05/06 12:59:21 WARN TaskSetManager: Stage 63 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:23 WARN TaskSetManager: Stage 64 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:27 WARN TaskSetManager: Stage 65 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:27 WARN TaskSetManager: Stage 66 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:27 WARN TaskSetManager: Stage 67 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:27 WARN TaskSetManager: Stage 68 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:27 WARN TaskSetManager: Stage 69 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:27 WARN TaskSetManager: Stage 70 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:27 WARN TaskSetManager: Stage 71 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:28 WARN TaskSetManager: Stage 72 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:30 WARN TaskSetManager: Stage 73 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
+----------+----------------+--------------------+--------------------+--------------------+----------+
|readmitted|time_in_hospital|              onehot|       rawPrediction|         probability|prediction|
+----------+----------------+--------------------+--------------------+--------------------+----------+
|       1.0|              10|(23,[0,7,10],[1.0...|[0.23888106737679...|[0.55943788751532...|       0.0|
|       1.0|              13|(23,[6,10,17],[1....|[-0.0939464268429...|[0.47653065232112...|       1.0|
|       0.0|               7|(23,[1,6,10],[1.0...|[-0.2278527171493...|[0.44328199371707...|       1.0|
|       1.0|               4|(23,[0,4,6,17],[1...|[0.04362960162014...|[0.51090567050963...|       0.0|
|       0.0|               4|(23,[0,7,10,11],[...|[-0.1327225979342...|[0.46686797209464...|       1.0|
|       0.0|               6|(23,[0,1,7,17],[1...|[-0.0707148295642...|[0.48232865591991...|       1.0|
|       0.0|               1|(23,[0,2,9,17],[1...|[0.03246321851185...|[0.50811509195920...|       0.0|
|       0.0|               5|(23,[0,6,7,9],[1....|[0.15437713053902...|[0.53851781566282...|       0.0|
|       0.0|              14|(23,[6,10,17],[1....|[-0.0939464268429...|[0.47653065232112...|       1.0|
|       0.0|               6|(23,[1,7],[1.0,1.0])|[-0.0346687241358...|[0.49133368696686...|       1.0|
+----------+----------------+--------------------+--------------------+--------------------+----------+
only showing top 10 rows

25/05/06 12:59:33 WARN TaskSetManager: Stage 81 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:34 WARN TaskSetManager: Stage 82 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:36 WARN TaskSetManager: Stage 83 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:37 WARN TaskSetManager: Stage 84 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
+----------+----------------+--------------------+--------------------+--------------------+----------+
|readmitted|time_in_hospital|              onehot|       rawPrediction|         probability|prediction|
+----------+----------------+--------------------+--------------------+--------------------+----------+
|       1.0|              10|(23,[0,7,10],[1.0...|[0.15589563216979...|[0.53889516604440...|       0.0|
|       1.0|              13|(23,[6,10,17],[1....|[0.15589563216979...|[0.53889516604440...|       0.0|
|       0.0|               7|(23,[1,6,10],[1.0...|[0.15589563216979...|[0.53889516604440...|       0.0|
|       1.0|               4|(23,[0,4,6,17],[1...|[0.15589563216979...|[0.53889516604440...|       0.0|
|       0.0|               4|(23,[0,7,10,11],[...|[0.15589563216979...|[0.53889516604440...|       0.0|
|       0.0|               6|(23,[0,1,7,17],[1...|[0.15589563216979...|[0.53889516604440...|       0.0|
|       0.0|               1|(23,[0,2,9,17],[1...|[0.15589563216979...|[0.53889516604440...|       0.0|
|       0.0|               5|(23,[0,6,7,9],[1....|[0.15589563216979...|[0.53889516604440...|       0.0|
|       0.0|              14|(23,[6,10,17],[1....|[0.15589563216979...|[0.53889516604440...|       0.0|
|       0.0|               6|(23,[1,7],[1.0,1.0])|[0.15589563216979...|[0.53889516604440...|       0.0|
+----------+----------------+--------------------+--------------------+--------------------+----------+
only showing top 10 rows

25/05/06 12:59:39 WARN TaskSetManager: Stage 92 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:41 WARN TaskSetManager: Stage 93 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
Accuracy of l2 is 0.5069124423963134

25/05/06 12:59:43 WARN TaskSetManager: Stage 102 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:45 WARN TaskSetManager: Stage 103 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:48 WARN TaskSetManager: Stage 115 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:50 WARN TaskSetManager: Stage 116 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
Manual Accuracy:  0.5069124423963134
25/05/06 12:59:54 WARN TaskSetManager: Stage 128 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
25/05/06 12:59:55 WARN TaskSetManager: Stage 129 contains a task of very large size (6385 KiB). The maximum recommended task size is 1000 KiB.
Accuracy of w/ elastic is 0.5345622119815668

